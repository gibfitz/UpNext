<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Recommendations</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;

        const RecommendationApp = () => {
          const [formData, setFormData] = useState({
            movies: '',
            tvShows: '',
            books: '',
            music: '',
            podcasts: ''
          });
          
          const [currentRecommendations, setCurrentRecommendations] = useState(null);
          const [isLoading, setIsLoading] = useState(false);
          const [showFeedback, setShowFeedback] = useState(false);
          const [feedback, setFeedback] = useState({});
          const [allFeedback, setAllFeedback] = useState([]);
          const [roundNumber, setRoundNumber] = useState(0);

          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({
              ...prev,
              [name]: value
            }));
          };

          const generateRecommendations = async (isRefinement = false) => {
            const hasInput = Object.values(formData).some(value => value.trim() !== '');
            if (!hasInput && !isRefinement) {
              alert('Please fill in at least one preference field.');
              return;
            }

            setIsLoading(true);
            setShowFeedback(false);
            
            setTimeout(() => {
              let newRecommendations;
              
              if (isRefinement && allFeedback.length > 0) {
                newRecommendations = generateRefinedRecommendations();
              } else {
                newRecommendations = generateInitialRecommendations();
              }
              
              setCurrentRecommendations(newRecommendations);
              setShowFeedback(true);
              setFeedback({});
              setRoundNumber(prev => prev + 1);
              setIsLoading(false);
            }, 2000);
          };

          const generateInitialRecommendations = () => {
            return {
              movies: formData.movies ? analyzeMovies(formData.movies) : [],
              tvShows: formData.tvShows ? analyzeTVShows(formData.tvShows) : [],
              books: formData.books ? analyzeBooks(formData.books) : [],
              music: formData.music ? analyzeMusic(formData.music) : [],
              podcasts: formData.podcasts ? analyzePodcasts(formData.podcasts) : []
            };
          };

          const generateRefinedRecommendations = () => {
            const likedItems = allFeedback.filter(f => f.rating === 'like');
            const dislikedItems = allFeedback.filter(f => f.rating === 'dislike');
            
            const refinedRecs = {
              movies: [],
              tvShows: [],
              books: [],
              music: [],
              podcasts: []
            };

            if (formData.movies) {
              const likedMovies = likedItems.filter(f => f.category === 'movies');
              refinedRecs.movies = likedMovies.length > 0 ? getRefinedMovieRecommendations() : getAlternativeMovieRecommendations();
            }

            if (formData.tvShows) {
              const likedTV = likedItems.filter(f => f.category === 'tvShows');
              refinedRecs.tvShows = likedTV.length > 0 ? getRefinedTVRecommendations() : getAlternativeTVRecommendations();
            }

            if (formData.books) {
              refinedRecs.books = getRefinedBookRecommendations();
            }

            if (formData.music) {
              refinedRecs.music = getRefinedMusicRecommendations();
            }

            if (formData.podcasts) {
              refinedRecs.podcasts = getRefinedPodcastRecommendations();
            }

            return refinedRecs;
          };

          const getRefinedMovieRecommendations = () => {
            const options = [
              { title: 'The Farewell', reason: 'Family dramedy with emotional depth and cultural themes, matching your positive feedback patterns.' },
              { title: 'Eighth Grade', reason: 'Authentic coming-of-age storytelling that aligns with your preferences.' },
              { title: 'Lady Bird', reason: 'Character-driven narrative with realistic relationships you seem to enjoy.' }
            ];
            return options;
          };

          const getAlternativeMovieRecommendations = () => {
            return [
              { title: 'The Social Network', reason: 'Different approach: Sharp dialogue and complex relationships.' },
              { title: 'Gone Girl', reason: 'Psychological thriller with unreliable narrators.' },
              { title: 'Mad Max: Fury Road', reason: 'Action-focused with visual storytelling.' }
            ];
          };

          const getRefinedTVRecommendations = () => {
            return [
              { title: 'Fleabag', reason: 'Character depth with innovative storytelling techniques.' },
              { title: 'Atlanta', reason: 'Character-driven comedy-drama with complexity.' },
              { title: 'The Good Place', reason: 'Smart comedy with philosophical elements.' }
            ];
          };

          const getAlternativeTVRecommendations = () => {
            return [
              { title: 'Succession', reason: 'Corporate family drama with sharp writing.' },
              { title: 'Stranger Things', reason: 'Sci-fi adventure with ensemble cast.' },
              { title: 'The Crown', reason: 'Historical drama with character study focus.' }
            ];
          };

          const getRefinedBookRecommendations = () => {
            return [
              { title: 'Circe', reason: 'Mythological retelling with character depth.' },
              { title: 'The Goldfinch', reason: 'Complex character study with emotional depth.' },
              { title: 'Normal People', reason: 'Relationship-focused with psychological complexity.' }
            ];
          };

          const getRefinedMusicRecommendations = () => {
            return [
              { title: 'Bon Iver', reason: 'Atmospheric indie folk with introspective qualities.' },
              { title: 'Sufjan Stevens', reason: 'Complex arrangements and thoughtful lyrics.' },
              { title: 'The Tallest Man on Earth', reason: 'Authentic singer-songwriter approach.' }
            ];
          };

          const getRefinedPodcastRecommendations = () => {
            return [
              { title: 'The Habitat', reason: 'Immersive storytelling matching narrative preferences.' },
              { title: '99% Invisible', reason: 'Design focus with intellectual curiosity.' },
              { title: 'Reply All', reason: 'Tech culture with investigative elements.' }
            ];
          };

          const analyzeMovies = (movies) => {
            if (!movies.trim()) return [];
            
            const movieDatabase = {
              'way way back': [
                { title: 'Little Miss Sunshine', reason: 'Family road trip comedy-drama with quirky characters and genuine emotional moments.' },
                { title: 'Hunt for the Wilderpeople', reason: 'Coming-of-age adventure with deadpan humor and unlikely friendship.' },
                { title: 'The Spectacular Now', reason: 'Authentic coming-of-age story with realistic character development.' }
              ],
              'love actually': [
                { title: 'About Time', reason: 'Romance with life\'s meaningful moments and British wit.' },
                { title: 'Four Weddings and a Funeral', reason: 'British romantic comedy with ensemble cast.' },
                { title: 'The Holiday', reason: 'Romantic ensemble with multiple storylines.' }
              ],
              'default': [
                { title: 'Parasite', reason: 'Social thriller with dark comedy and plot twists.' },
                { title: 'The Grand Budapest Hotel', reason: 'Visual comedy with eccentric characters.' },
                { title: 'Manchester by the Sea', reason: 'Emotional drama exploring grief and relationships.' }
              ]
            };
            
            const lowerMovies = movies.toLowerCase();
            for (const [key, recs] of Object.entries(movieDatabase)) {
              if (lowerMovies.includes(key)) {
                return recs;
              }
            }
            return movieDatabase.default;
          };

          const analyzeTVShows = (shows) => {
            if (!shows.trim()) return [];
            
            const showDatabase = {
              'ozark': [
                { title: 'Breaking Bad', reason: 'Family crime dynamics with moral compromises.' },
                { title: 'Better Call Saul', reason: 'Character-driven crime drama with moral ambiguity.' },
                { title: 'Yellowjackets', reason: 'Psychological thriller with ensemble storytelling.' }
              ],
              'the office': [
                { title: 'Parks and Recreation', reason: 'Workplace mockumentary with optimistic characters.' },
                { title: 'Brooklyn Nine-Nine', reason: 'Ensemble workplace comedy with character growth.' },
                { title: 'Ted Lasso', reason: 'Feel-good comedy focused on relationships.' }
              ],
              'seinfeld': [
                { title: 'Curb Your Enthusiasm', reason: 'Observational humor with awkward social situations.' },
                { title: 'It\'s Always Sunny', reason: 'Character-driven comedy with absurd situations.' },
                { title: 'Veep', reason: 'Political satire with rapid-fire dialogue.' }
              ],
              'wayne': [
                { title: 'The End of the F***ing World', reason: 'Dark coming-of-age with road trip elements.' },
                { title: 'I Am Not Okay with This', reason: 'Teen angst with supernatural elements.' },
                { title: 'Russian Doll', reason: 'Genre-bending with complex character development.' }
              ],
              'default': [
                { title: 'The Bear', reason: 'Workplace dramedy with authentic character dynamics.' },
                { title: 'Severance', reason: 'Mind-bending workplace thriller.' },
                { title: 'Only Murders in the Building', reason: 'Mystery comedy with great chemistry.' }
              ]
            };
            
            const lowerShows = shows.toLowerCase();
            for (const [key, recs] of Object.entries(showDatabase)) {
              if (lowerShows.includes(key)) {
                return recs;
              }
            }
            return showDatabase.default;
          };

          const analyzeBooks = (books) => {
            if (!books.trim()) return [];
            
            const bookDatabase = {
              'midnight library': [
                { title: 'The Seven Husbands of Evelyn Hugo', reason: 'Life choices exploration through compelling character study.' },
                { title: 'Klara and the Sun', reason: 'Philosophical exploration of consciousness and connection.' },
                { title: 'The Invisible Life of Addie LaRue', reason: 'Magical realism exploring identity across time.' }
              ],
              'the dog stars': [
                { title: 'Station Eleven', reason: 'Post-apocalyptic focusing on human connections.' },
                { title: 'The Road', reason: 'Survival story with deep relationship dynamics.' },
                { title: 'Zone One', reason: 'Literary approach to genre fiction.' }
              ],
              'default': [
                { title: 'Where the Crawdads Sing', reason: 'Mystery with beautiful writing and character development.' },
                { title: 'Educated', reason: 'Memoir about transformation and family.' },
                { title: 'The Thursday Murder Club', reason: 'Cozy mystery with charming protagonists.' }
              ]
            };
            
            const lowerBooks = books.toLowerCase();
            for (const [key, recs] of Object.entries(bookDatabase)) {
              if (lowerBooks.includes(key)) {
                return recs;
              }
            }
            return bookDatabase.default;
          };

          const analyzeMusic = (music) => {
            if (!music.trim()) return [];
            
            const musicDatabase = {
              'rem': [
                { title: 'The National', reason: 'Introspective indie rock with thoughtful lyrics.' },
                { title: 'Arcade Fire', reason: 'Alternative rock with anthemic qualities.' },
                { title: 'Vampire Weekend', reason: 'Indie rock with literary sophistication.' }
              ],
              'u2': [
                { title: 'Coldplay', reason: 'Stadium anthems with emotional depth.' },
                { title: 'Radiohead', reason: 'Experimental rock with innovative textures.' },
                { title: 'The Killers', reason: 'Arena rock with memorable hooks.' }
              ],
              'lyle lovett': [
                { title: 'Wilco', reason: 'Alt-country with storytelling focus.' },
                { title: 'Ryan Adams', reason: 'Singer-songwriter with emotional vulnerability.' },
                { title: 'Jason Isbell', reason: 'Masterful storytelling with personal narratives.' }
              ],
              'default': [
                { title: 'Phoebe Bridgers', reason: 'Indie folk with introspective songwriting.' },
                { title: 'The War on Drugs', reason: 'Atmospheric rock with nostalgic soundscapes.' },
                { title: 'Fleet Foxes', reason: 'Harmonious folk with lush arrangements.' }
              ]
            };
            
            const lowerMusic = music.toLowerCase();
            for (const [key, recs] of Object.entries(musicDatabase)) {
              if (lowerMusic.includes(key)) {
                return recs;
              }
            }
            return musicDatabase.default;
          };

          const analyzePodcasts = (podcasts) => {
            if (!podcasts.trim()) return [];
            
            const podcastDatabase = {
              's-town': [
                { title: 'In the Dark', reason: 'Investigative journalism with deep criminal case analysis.' },
                { title: 'Bear Brook', reason: 'True crime with meticulous research and narrative.' },
                { title: 'The Thing About Pam', reason: 'Crime investigation with complex characters.' }
              ],
              'revisionist history': [
                { title: 'You\'re Wrong About', reason: 'Reexamining cultural myths with humor and insight.' },
                { title: 'Decoder Ring', reason: 'Cultural analysis uncovering hidden stories.' },
                { title: 'The Memory Palace', reason: 'Historical storytelling with forgotten narratives.' }
              ],
              'working it out': [
                { title: 'Conan O\'Brien Needs a Friend', reason: 'Creative conversations with comedic perspective.' },
                { title: 'WTF with Marc Maron', reason: 'In-depth interviews about creative process.' },
                { title: 'Armchair Expert', reason: 'Celebrity conversations focused on vulnerability.' }
              ],
              'default': [
                { title: 'The Daily', reason: 'Daily news analysis with clear explanations.' },
                { title: 'This American Life', reason: 'Narrative storytelling with diverse topics.' },
                { title: 'Radiolab', reason: 'Science exploration with innovative sound design.' }
              ]
            };
            
            const lowerPodcasts = podcasts.toLowerCase();
            for (const [key, recs] of Object.entries(podcastDatabase)) {
              if (lowerPodcasts.includes(key)) {
                return recs;
              }
            }
            return podcastDatabase.default;
          };

          const handleFeedback = (category, title, rating) => {
            const feedbackKey = `${category}_${title}`;
            setFeedback(prev => ({
              ...prev,
              [feedbackKey]: rating
            }));
          };

          const submitFeedback = () => {
            const newFeedbackEntries = Object.entries(feedback).map(([key, rating]) => {
              const [category, ...titleParts] = key.split('_');
              const title = titleParts.join('_');
              return {
                category,
                title,
                rating,
                round: roundNumber
              };
            });
            
            setAllFeedback(prev => [...prev, ...newFeedbackEntries]);
            generateRecommendations(true);
          };

          const renderRecommendations = (recs, category) => {
            if (!recs || recs.length === 0) return null;

            return React.createElement('div', {
              className: "mb-6"
            },
              React.createElement('h3', {
                className: "text-lg font-semibold mb-3 text-gray-800"
              }, getCategoryTitle(category)),
              
              recs.map((item, index) =>
                React.createElement('div', {
                  key: `${category}_${index}`,
                  className: "bg-white rounded-lg p-4 mb-3 border border-gray-200"
                },
                  React.createElement('div', {
                    className: "flex justify-between items-start mb-2"
                  },
                    React.createElement('h4', {
                      className: "font-semibold text-gray-800"
                    }, `${index + 1}. ${item.title}`),
                    
                    React.createElement('div', {
                      className: "flex gap-2"
                    },
                      React.createElement('button', {
                        onClick: () => handleFeedback(category, item.title, 'like'),
                        className: `px-2 py-1 rounded text-xs transition-all ${
                          feedback[`${category}_${item.title}`] === 'like' 
                            ? 'bg-green-500 text-white transform scale-110' 
                            : 'bg-gray-200 hover:bg-green-100'
                        }`
                      }, "ðŸ‘"),
                      React.createElement('button', {
                        onClick: () => handleFeedback(category, item.title, 'dislike'),
                        className: `px-2 py-1 rounded text-xs transition-all ${
                          feedback[`${category}_${item.title}`] === 'dislike' 
                            ? 'bg-red-500 text-white transform scale-110' 
                            : 'bg-gray-200 hover:bg-red-100'
                        }`
                      }, "ðŸ‘Ž")
                    )
                  ),
                  React.createElement('p', {
                    className: "text-sm text-gray-600 leading-relaxed"
                  }, item.reason)
                )
              )
            );
          };

          const getCategoryTitle = (category) => {
            const titles = {
              movies: 'ðŸŽ¬ MOVIES',
              tvShows: 'ðŸ“º TV SHOWS', 
              books: 'ðŸ“š BOOKS',
              music: 'ðŸŽµ MUSIC ARTISTS',
              podcasts: 'ðŸŽ§ PODCASTS'
            };
            return titles[category] || category;
          };

          return React.createElement('div', {
            className: "min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-blue-800 p-6"
          }, 
            React.createElement('div', {
              className: "max-w-4xl mx-auto"
            },
              React.createElement('div', {
                className: "bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 mb-6"
              },
                React.createElement('h1', {
                  className: "text-4xl font-bold text-center mb-2 bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent"
                }, "ðŸŽ¬ Personal Recommendations"),
                React.createElement('p', {
                  className: "text-center text-gray-600 mb-8"
                }, roundNumber === 0 ? "Get detailed, personalized recommendations with explanations" : `Round ${roundNumber + 1}: Even better recommendations based on your feedback!`),
                
                React.createElement('div', {
                  className: "grid gap-6"
                },
                  React.createElement('div', {
                    className: "space-y-2"
                  },
                    React.createElement('label', {
                      className: "block text-sm font-semibold text-gray-700"
                    }, "ðŸŽ¬ Favorite Movies"),
                    React.createElement('input', {
                      type: "text",
                      name: "movies",
                      value: formData.movies,
                      onChange: handleInputChange,
                      placeholder: "e.g., Inception, The Matrix, Love Actually",
                      className: "w-full p-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-200"
                    })
                  ),
                  
                  React.createElement('div', {
                    className: "space-y-2"
                  },
                    React.createElement('label', {
                      className: "block text-sm font-semibold text-gray-700"
                    }, "ðŸ“º Favorite TV Shows"),
                    React.createElement('input', {
                      type: "text",
                      name: "tvShows",
                      value: formData.tvShows,
                      onChange: handleInputChange,
                      placeholder: "e.g., The Office, Breaking Bad, Ozark",
                      className: "w-full p-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-200"
                    })
                  ),
                  
                  React.createElement('div', {
                    className: "space-y-2"
                  },
                    React.createElement('label', {
                      className: "block text-sm font-semibold text-gray-700"
                    }, "ðŸ“š Favorite Books"),
                    React.createElement('input', {
                      type: "text",
                      name: "books",
                      value: formData.books,
                      onChange: handleInputChange,
                      placeholder: "e.g., The Midnight Library, Harry Potter",
                      className: "w-full p-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-200"
                    })
                  ),
                  
                  React.createElement('div', {
                    className: "space-y-2"
                  },
                    React.createElement('label', {
                      className: "block text-sm font-semibold text-gray-700"
                    }, "ðŸŽµ Favorite Musical Artists"),
                    React.createElement('input', {
                      type: "text",
                      name: "music",
                      value: formData.music,
                      onChange: handleInputChange,
                      placeholder: "e.g., The Beatles, Taylor Swift, R.E.M.",
                      className: "w-full p-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-200"
                    })
                  ),
                  
                  React.createElement('div', {
                    className: "space-y-2"
                  },
                    React.createElement('label', {
                      className: "block text-sm font-semibold text-gray-700"
                    }, "ðŸŽ§ Favorite Podcasts"),
                    React.createElement('input', {
                      type: "text",
                      name: "podcasts",
                      value: formData.podcasts,
                      onChange: handleInputChange,
                      placeholder: "e.g., Serial, This American Life, S-Town",
                      className: "w-full p-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all duration-200"
                    })
                  ),
                  
                  React.createElement('button', {
                    onClick: () => generateRecommendations(false),
                    disabled: isLoading,
                    className: "w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-4 px-8 rounded-xl hover:from-purple-700 hover:to-blue-700 transform hover:scale-105 transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
                  }, isLoading ? 
                    React.createElement('span', {
                      className: "flex items-center justify-center"
                    },
                      React.createElement('div', {
                        className: "animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"
                      }),
                      "Analyzing Your Taste..."
                    ) :
                    roundNumber === 0 ? "âœ¨ Get My Recommendations" : "ðŸ”„ Get New Recommendations"
                  )
                )
              ),
              
              currentRecommendations && React.createElement('div', {
                className: "bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 mb-6"
              },
                React.createElement('h2', {
                  className: "text-2xl font-bold text-gray-800 mb-6 text-center"
                }, roundNumber === 1 ? "Your Personalized Recommendations" : `Refined Recommendations (Round ${roundNumber})`),
                
                React.createElement('div', {
                  className: "space-y-6"
                },
                  renderRecommendations(currentRecommendations.movies, 'movies'),
                  renderRecommendations(currentRecommendations.tvShows, 'tvShows'),
                  renderRecommendations(currentRecommendations.books, 'books'),
                  renderRecommendations(currentRecommendations.music, 'music'),
                  renderRecommendations(currentRecommendations.podcasts, 'podcasts')
                ),
                
                showFeedback && React.createElement('div', {
                  className: "mt-8 p-6 bg-blue-50 rounded-xl"
                },
                  React.createElement('h3', {
                    className: "text-lg font-semibold text-gray-800 mb-3"
                  }, "ðŸ’¬ Rate These Recommendations"),
                  React.createElement('p', {
                    className: "text-gray-600 mb-4"
                  }, "Click ðŸ‘ or ðŸ‘Ž on individual recommendations above, then get even better suggestions!"),
                  
                  React.createElement('div', {
                    className: "flex gap-4 items-center"
                  },
                    React.createElement('span', {
                      className: "text-sm text-gray-600"
                    }, `Feedback given: ${Object.keys(feedback).length} items`),
                    
                    React.createElement('button', {
                      onClick: submitFeedback,
                      disabled: Object.keys(feedback).length === 0 || isLoading,
                      className: "flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
                    }, isLoading ? 
                      React.createElement('span', {
                        className: "flex items-center justify-center"
                      },
                        React.createElement('div', {
                          className: "animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"
                        }),
                        "Learning from feedback..."
                      ) :
                      "ðŸŽ¯ Get Better Recommendations Based on My Feedback"
                    )
                  ),
                  
                  allFeedback.length > 0 && React.createElement('div', {
                    className: "mt-4 p-3 bg-white rounded-lg"
                  },
                    React.createElement('p', {
                      className: "text-xs text-gray-500"
                    }, `Total feedback collected: ${allFeedback.length} items across ${Math.max(...allFeedback.map(f => f.round))} rounds`)
                  )
                )
              )
            )
          );
        };

        ReactDOM.render(React.createElement(RecommendationApp), document.getElementById('root'));
    </script>
</body>
</html>
